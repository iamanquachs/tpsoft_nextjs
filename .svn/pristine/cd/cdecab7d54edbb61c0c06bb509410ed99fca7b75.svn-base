import { Container, Row, Col } from "react-bootstrap";
import Iframe from "react-iframe";
import Image from "next/image";
import Footer from "@/components/footer";
import Footer_LH from "../components/footer_lienhe.jsx";
import React, { useState, useEffect } from "react";
import mailAPI from "./api/mailAPI";

export default function Contact() {
  var [ghichu, setGhichu] = useState("");
  var [dienthoai, setDienthoai] = useState("");
  var [hoten, setHoten] = useState("");
  const [showModal, setShowModal] = useState(false);

  const sendEmail = async (e) => {
    const error = document.getElementById("title_error");
    const success = document.getElementById("title_success");
    error.classList.add("hidden");
    success.classList.add("hidden");

    if (dienthoai != "" && hoten != "") {
      try {
        const params = {
          hoten: hoten,
          dienthoai: dienthoai,
          ghichu: ghichu,
          loai: "",
        };
        await mailAPI.send_mail(params);
      } catch (error) {
        console.log(error);
      }
      setGhichu("");
      setDienthoai("");
      setHoten("");
      success.classList.remove("hidden");
      setTimeout(() => {
        success.classList.add("hidden");
      }, 2000);
    } else {
      error.classList.remove("hidden");
      setTimeout(() => {
        error.classList.add("hidden");
      }, 2000);
    }
  };

  const replaceSDT = (e) => {
    const value = e.target.value.replace(/[^0-9\.\,]/g, "");
    document.getElementById("dienthoai").value = value;
  };
  return (
    <>
      <div className="contact_wrap">
        <div className="section_lienhe_header">
          <div className="section_header_title_left">
            <p>
              TPSoft luôn nỗ lực sáng tạo sản phẩm ngày một thông minh hơn và
              tiện ích hơn nhằm thực hiện khát vọng ứng dụng những thành tựu của
              công nghệ vào lĩnh vực y tế
            </p>
          </div>
        </div>
        <Container>
          <Row>
            <Col xs={7}>
              <div className="section_home_contact">
                <h4 style={{color:'#818181'}}>Đường đến TPSoft</h4>
                <div className="section_content">
                  <Iframe
                    title="google-map"
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3928.9390258040494!2d105.75381081428208!3d10.021890575407971!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31a0884866ca3b4f%3A0x5673e506d4de6841!2zQ8O0bmcgVHkgVG5oaCBDw7RuZyBOZ2jhu4cgUGjhuqduIE3hu4FtIFRwc29mdA!5e0!3m2!1svi!2s!4v1613835567640!5m2!1svi!2s"
                    width="100%"
                    height="500px"
                    style="border:0;"
                    allowFullScreen
                    loading="lazy"
                  />
                </div>
              </div>
            </Col>
            <Col xs={5}>
              <div className="section_home_contact ">
                <h4 style={{color:'#818181'}}>Liên hệ với TPSoft</h4>
                <div className="section_home_div">
                  <input style={{color:'black'}}
                    type="text"
                    name="name"
                    autoComplete="off"
                    placeholder="Họ tên (*)"
                    onChange={(e) => {
                      setHoten(e.target.value);
                    }}
                    value={hoten}
                  />
                  <input style={{color:'black'}}
                    type="text"
                    name="name"
                    autoComplete="off"
                    placeholder="Điện thoại (*)"
                    id="dienthoai"
                    onKeyUp={(e) => {
                      replaceSDT(e);
                    }}
                    onChange={(e) => {
                      setDienthoai(e.target.value);
                    }}
                    value={dienthoai}
                  />
                  <input style={{color:'black'}}
                    type="text"
                    name="name"
                    autoComplete="off"
                    placeholder="Nội dung"
                    onChange={(e) => {
                      setGhichu(e.target.value);
                    }}
                    value={ghichu}
                  />
                  <div className="flex_contact">
                    <p id="title_error" style={{color:'red'}} className="hidden">
                      Chưa nhập đủ thông tin
                    </p>
                    <p id="title_success"style={{color:'green'}} className="hidden">
                      Gửi thành công
                    </p>
                    <button style={{backgroundColor:'#024893', color:'white'}}
                      onClick={(e) => {
                        sendEmail();
                      }}
                      type="button"
                    >
                      Gửi
                    </button>
                  </div>
                </div>
              </div>
            </Col>
          </Row>
        </Container>
      </div>
      <Footer_LH />
      <Footer />
    </>
  );
}
